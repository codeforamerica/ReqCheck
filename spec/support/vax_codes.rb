module TextVax
  VAXCODES = {
    FLUZ: [['Flu, Preservative Free', 'UNK', '1517', 140],
           ['Flu, Preservative Free', 'SKB', nil, 140]],
    HPV9: [['HPV, Quadrivalent, Gardasil', 'MSD', '13429', 62]],
    FLZ: [['Flu, unspecified', 'UNK', '1514501', 141],
          ['Flu, unspecified', 'PMC', nil, 141],
          ['Flu, unspecified', nil, nil, 141]],
    MCV6: [['C-Meningococcal, Bexsero', 'GSK', '148901A', 163]],
    HepB: [['C-Hepatitis B Vaccine', 'UNK', '237PJ', 8],
           ['C-Hepatitis B Vaccine', 'SKB', '2XZ75', 8],
           ['C-Hepatitis B Vaccine', 'GSK', '475PE', 8],
           ['C-Hepatitis B Vaccine', 'MRK', 'K026666', 8],
           ['C-Hepatitis B Vaccine', nil, nil, 8],
           ['C-Hepatitis B Vaccine', 'MSD', nil, 8]],
    HAV6: [['A-Hepatitis A Vaccine-Ped/adol', 'UNK', '294X9', 83],
           ['A-Hepatitis A Vaccine-Ped/adol', 'SKB', '294X9', 83],
           ['A-Hepatitis A Vaccine-Ped/adol', 'MSD', nil, 83]],
    HAV9: [['Hepatitis A Vaccine, Adult', 'UNK', '2F559', 52]],
    DTHI: [['C-DTaP/Hep B/IPV', 'SKB', '2PY24', 110],
           ['C-DTaP/Hep B/IPV', 'GSK', 'AE9JZ', 110],
           ['C-DTaP/Hep B/IPV', nil, nil, 110]],
    FLU: [['A-Flu', 'SKB', '3343R', 150],
          ['A-Flu', 'PMC', '397A7', 150],
          ['A-Flu', 'SFP', 'UI441AD', 150]],
    FL11: [['C-317 Adult Flu', 'GSK', '37CC4', 141]],
    TWNz: [['Twinrix, HAV/HBV', 'SKB', '3ED7N', 104]],
    FL10: [['C-Flu Pres. Free (3-18 years)', 'GSK', '3L9LD', 140],
           ['C-Flu Pres. Free (3-18 years)', 'SFP', 'U5309BA', 140],
           ['C-Flu Pres. Free (3-18 years)', nil, nil, 140]],
    DTI: [['C-DTaP/IPV', 'GSK', '3N7Y7', 130],
          ['C-DTaP/IPV', 'SKB', '3N7Y7', 130]],
    TWN1: [['A-Twinrix Travel Vaccine', 'GSK', '3NK9A', 104],
           ['A-Twinrix Travel Vaccine', nil, nil, 104]],
    HAV3: [['C-Hepatitis A Vaccine (2 Dose)', 'GSK', '3RB2G', 83],
           ['C-Hepatitis A Vaccine (2 Dose)', 'MRK', 'L002717', 83],
           ['C-Hepatitis A Vaccine (2 Dose)', nil, nil, 83]],
    TDP9: [['Tdap', 'UNK', '435P7', 115],
           ['Tdap', 'SKB', '9N74F', 115]],
    HBV9: [['Hepatitis B Vaccine, Adult', 'SKB', '45SJ2', 43]],
    RAB1: [['A-Rabies Vaccine', 'UNK', '550011A', 18],
           ['A-Rabies Vaccine', 'SFP', 'K16133', 18]],
    HBV3: [['C-317 Adult Hepatitis B', 'GSK', '5G943', 43],
           ['C-317 Adult Hepatitis B', 'MRK', 'K010238', 43]],
    TDP1: [['A-Td with Pertussis, Tdap', 'GSK', '5MG55', 115],
           ['A-Td with Pertussis, Tdap', nil, nil, 115]],
    HAV1: [['A-Hepatitis A Vaccine', 'GSK', '793JR', 52],
           ['A-Hepatitis A Vaccine', nil, nil, 52]],
    TWN3: [['C-317 Adult Twinrix', 'GSK', '925P2', 104]],
    TDP2: [['C-Tdap', 'GSK', '95L3P', 115],
           ['C-Tdap', 'SFP', 'U5095AA', 115],
           ['C-Tdap', nil, nil, 115]],
    Td: [['A-Tetanus/Diptheria', 'MBL', 'A080A', 9],
         ['A-Tetanus/Diptheria', 'SFP', 'C4469AA', 9],
         ['A-Tetanus/Diptheria', nil, nil, 9]],
    MCV5: [['C-Meningococcal, Menveo', 'NOV', 'A15009', 136]],
    ROT1: [['C-Rotavirus (2 dose)', 'GSK', 'A41CB515A', 119],
           ['C-Rotavirus (2 dose)', 'UNK', 'A41FB512A', 119],
           ['C-Rotavirus (2 dose)', nil, nil, 119],
           ['C-Rotavirus (2 dose)', 'SKB', nil, 119]],
    DTaP: [['C-DTaP', 'GSK', 'AC7AG', 20],
           ['C-DTaP', 'UNK', 'C4781AA', 20],
           ['C-DTaP', 'SKB', nil, 20],
           ['C-DTaP', nil, nil, 20]],
    TD4: [['C-317 Adult Td', 'SFP', 'C4469AA', 113]],
    PPD1: [['A-Tuberculin Skin Test', 'SFP', 'C4515AA', 96],
           ['A-Tuberculin Skin Test', nil, nil, 96]],
    PPD9: [['Tuberculin Skin Test', 'SFP', 'C4582AA', 96],
           ['Tuberculin Skin Test', nil, nil, 96]],
    TD2: [['C-Td 7+', 'SFP', 'C4736BA', 113],
          ['C-Td 7+', nil, nil, 113]],
    TD9: [['Tetanus, Diphtheria', 'UNK', 'C4736CA', 9]],
    DHI: [['C-DTaP/HIB/IPV', 'PMC', 'C4806AA', 120],
          ['C-DTaP/HIB/IPV', 'SFP', 'C4855AA', 120],
          ['C-DTaP/HIB/IPV', nil, nil, 120]],
    HBV1: [['A-Hepatitis B Vaccine', 'GSK', 'F3BB3', 43],
           ['A-Hepatitis B Vaccine', nil, nil, 43]],
    FLU7: [['C-Flumist (Live, Intranasal)', 'MED', 'FJ2099', 111],
           ['C-Flumist (Live, Intranasal)', nil, nil, 111]],
    HAV4: [['C-317 Adult Hepatitis A', 'MRK', 'J007800', 52],
           ['C-317 Adult Hepatitis A', 'GSK', 'K002831', 52]],
    HPV3: [['H-HPV Vaccine (HCF Grant)', 'MRK', 'J009788', 62]],
    ROTA: [['C-Rotavirus (3 dose)', 'MRK', 'K004773', 116],
           ['C-Rotavirus (3 dose)', nil, nil, 116]],
    PPV2: [['C-317 Adult Pneumococcal PPV23', 'MRK', 'K008410', 33]],
    PPV9: [['Pneumococcal Vaccine PPV23', 'UNK', 'K008410', 33]],
    PCV9: [['Pneumococcal Conjugate, PCV13', 'PFR', 'K009874', 133],
           ['Pneumococcal Conjugate, PCV13', nil, nil, 133]],
    HPV5: [['C-317 Adult HPV', 'MRK', 'K010215', 62]],
    HPV: [['C-HPV, Quad, Gardasil', 'MRK', 'K010215', 62],
          ['C-HPV, Quad, Gardasil', nil, nil, 62]],
    MMR3: [['C-317 Adult MMR', 'MRK', 'K010318', 3]],
    MMR: [['C-Measles, Mumps, Rubella', 'MRK', 'K010318', 3],
          ['C-Measles, Mumps, Rubella', nil, nil, 3]],
    MMR9: [['Measles, Mumps, Rubella', 'UNK', 'K010318', 3],
           ['Measles, Mumps, Rubella', 'MSD', 'L003859', 3]],
    VAR2: [['C-Varicella', 'MRK', 'K010337', 21],
           ['C-Varicella', nil, nil, 21]],
    VAR9: [['Varicella Vaccine', 'MSD', 'K015971', 21]],
    VAR4: [['C-317 Adult Varicella', 'MRK', 'K016129', 21]],
    PPV1: [['A-Pneumococcal Vaccine PPV23', 'MRK', 'K019933', 33]],
    POL: [['C-Polio (Unknown Type)', 'UNK', 'K1330', 10],
          ['C-Polio (Unknown Type)', 'PMC', 'L1001-1', 10],
          ['polio, unspecified formulation', 'UNK', nil, 89]],
    IPV: [['C-IPV', 'SFP', 'K13301', 10],
          ['C-IPV', nil, nil, 10]],
    TYP: [['A-Typhoid Vaccine', 'SFP', 'K1536', 101]],
    IPV1: [['A-Polio', 'SFP', 'K1694-1', 10]],
    MMR1: [['A-Measles, Mumps, Rubella', 'MRK', 'L003855', 3],
           ['A-Measles, Mumps, Rubella', nil, nil, 3]],
    MMRV: [['C-MMR/Varicella', 'MSD', 'L007230', 94],
           ['C-MMR/Varicella', nil, nil, 94]],
    PRPO: [['HIB Conjugate (Mening. Prot)', 'UNK', 'L009649', 49],
           ['HIB Conjugate (Mening. Prot)', 'MSD', nil, 49]],
    PRPT: [['HIB polyrib. - Tetanus tox', 'UNK', 'L012838', 48]],
    VAR1: [['A-Varicella Vaccine', 'MRK', 'L013063', 21],
           ['A-Varicella Vaccine', nil, nil, 21]],
    HPV6: [['C-HPV, 9', 'MRK', 'L013429', 165],
           ['C-HPV, 9', 'MSD', 'L013429', 165],
           ['C-HPV, 9', nil, nil, 165]],
    MCV7: [['C-Meningococcal, Trumenba', 'PFR', 'L13514', 162]],
    PCV2: [['C-Pneumococcal Conjugate PCV13', 'WA', 'L53937', 133],
           ['C-Pneumococcal Conjugate PCV13', 'PFR', 'L74252', 133],
           ['C-Pneumococcal Conjugate PCV13', nil, nil, 133]],
    PCV: [['C-Pneumococcal Conjugate PCV7', 'UNK', 'LO1342B', 100]],
    MCV9: [['Meningococcal, Menactra', 'PMC', 'LU5021AB', 114]],
    RIG: [['Rabies Immune Globulin (RIG)', 'UNK', 'R1AD400051', 34]],
    TD5: [['Td, Adult, preservative-free', 'PMC', 'U4669AA', 113],
          ['Td, Adult, preservative-free', 'UNK', nil, 113]],
    MCV3: [['C-317 Adult Meningococcal', 'SFP', 'U5020CA', 114]],
    MCV4: [['C-Meningococcal, Menactra', 'SFP', 'U5082AB', 114],
           ['C-Meningococcal, Menactra', nil, nil, 114]],
    TDP4: [['C-317 Adult Tdap', 'SFP', 'U5095AA', 115]],
    FLU9: [['C-Flu Pres. Free (6-35 months)', 'SFP', 'U5319DA', 140],
           ['C-Flu Pres. Free (6-35 months)', nil, nil, 140]],
    YFV: [['A-Yellow Fever Vaccine', 'SFP', 'UI106AA', 37]],
    HIB2: [['C-HIB', 'SFP', 'UI149AAA', 49],
           ['C-HIB', nil, nil, 49]],
    FLU8: [['A-Flu High Dose (65+)', 'PMC', 'UI427AA', 135],
           ['A-Flu High Dose (65+)', 'SFP', 'UI466AA', 135]],
    FLU6: [['A-Flu (preservative free)', 'SFP', 'UI445AA', 140],
           ['A-Flu (preservative free)', nil, nil, 140]],
    FL14: [['Influenza Virus, split, unspec', 'UNK', 'UI445AC', 15]],
    DTP: [['C-DTP', nil, nil, 1]],
    HAV5: [['Hepatitis A, unspecified', 'UNK', nil, 85]],
    HBV6: [['Hepatitis B, unspecified', 'UNK', nil, 45]],
    HIB: [['HIB Unspecified', 'UNK', nil, 17]],
    PCV4: [['A-Pneumococcal Conjugate PCV13', nil, nil, 133]],
    H1N4: [['C-H1N1 Influenza Vaccine', 'UNK', nil, 127]],
    HBIG: [['Hepatitis B Immune Globulin', nil, nil, 30]],
    ROT2: [['Rotavirus, unspecified', 'UNK', nil, 122]],
    OPV: [['Oral Polio Vaccine', 'UNK', nil, 02]]
  }

  TRADENAMES = {
    ACA75: 'ACAM2000',
    PMC75: 'ACAM2000',
    NONE20: 'ACEL-IMUNE',
    PMC48: 'ACTHIB',
    PMC115: 'ADACEL',
    BRR143: 'Adenovirus types 4 and 7',
    CSL141: 'AFLURIA',
    SEQ141: 'Afluria',
    CSL140: 'Afluria, preservative free',
    SEQ140: 'Afluria, preservative free',
    NOV140: 'AGRIFLU',
    SKB801: 'AS03 adjuvant',
    MSD05: 'ATTENUVAX',
    NOV163: 'Bexsero',
    SKB163: 'Bexsero',
    NONE38: 'BIAVAX II',
    MIP24: 'BIOTHRAX',
    SKB115: 'BOOSTRIX',
    NONE20: 'CERTIVA',
    SKB118: 'CERVARIX',
    MSD51: 'COMVAX',
    PMC106: 'DAPTACEL',
    PMC113: 'DECAVAC',
    NONE75: 'DRYVAX',
    PMC28: 'DT(GENERIC)',
    SKB08: 'ENGERIX B-PEDS',
    SKB43: 'ENGERIX-B-ADULT',
    NOV168: 'Fluad',
    SEQ168: 'Fluad',
    SKB140: 'FLUARIX',
    SKB150: 'Fluarix, quadrivalent, preservative free',
    PSC155: 'Flublok',
    NOV153: 'Flucelvax',
    SEQ171: 'flucelvax, quadrivalent',
    IDB141: 'FLULAVAL',
    IDB158: 'Flulaval quadrivalent',
    IDB150: 'Flulaval, quadrivalent, preservative free',
    MED111: 'FLUMIST',
    MED149: 'Flumist quadrivalent',
    NOV141: 'FLUVIRIN',
    NOV140: 'FLUVIRIN-PRESERVATIVE FREE',
    PMC141: 'FLUZONE',
    PMC166: 'Fluzone Quad Intradermal',
    PMC161: 'Fluzone Quadrivalent, pediatric',
    PMC144: 'Fluzone, intradermal',
    PMC158: 'Fluzone, Quadrivalent',
    PMC150: 'Fluzone, quadrivalent, preservative free',
    PMC135: 'FLUZONE-HIGH DOSE',
    PMC140: 'FLUZONE-PRESERVATIVE FREE',
    MSD62: 'GARDASIL',
    MSD165: 'Gardasil 9',
    SKB52: 'HAVRIX-ADULT',
    SKB83: 'HAVRIX-PEDS',
    SKB48: 'HIBERIX',
    NONE47: 'HIBTITER',
    PMC18: 'IMOVAX',
    PMC40: 'IMOVAX ID',
    SKB20: 'INFANRIX',
    IDB160: 'Influenza A (H5N1) -2013',
    SKB160: 'Influenza A monovalent (H5N1), ADJUVANTED-2013',
    PMC10: 'IPOL',
    VAL134: 'Ixiaro',
    INT134: 'IXIARO',
    NONE39: 'JE-VAX',
    SKB130: 'KINRIX',
    PMC114: 'MENACTRA',
    SKB148: 'MENHIBRIX',
    PMC32: 'MENOMUNE',
    SKB136: 'Menveo',
    NOV136: 'MENVEO',
    MSD06: 'MERUVAX II',
    MSD03: 'M-M-R II',
    NONE07: 'MUMPSVAX',
    NONE19: 'MYCOBAX',
    NOV127: 'Novel influenza-H1N1-09',
    PMC127: 'Novel influenza-H1N1-09',
    CSL127: 'Novel influenza-H1N1-09',
    MED125: 'Novel Influenza-H1N1-09, nasal',
    PMC126: 'Novel influenza-H1N1-09, preservative-free',
    NOV126: 'Novel influenza-H1N1-09, preservative-free',
    CSL126: 'Novel influenza-H1N1-09, preservative-free',
    NONE48: 'OMNIHIB',
    NONE02: 'ORIMUNE',
    SKB110: 'PEDIARIX',
    MSD49: 'PEDVAXHIB',
    PMC120: 'PENTACEL',
    MSD33: 'PNEUMOVAX 23',
    WAL133: 'PREVNAR 13',
    PFR133: 'PREVNAR 13',
    WAL100: 'PREVNAR 7',
    WAL100: 'PREVNAR 7',
    NONE46: 'PROHIBIT',
    MSD94: 'PROQUAD',
    PMC130: 'Quadracel',
    CHI40: 'RabAvert',
    NOV18: 'RABAVERT',
    SKB18: 'Rabavert',
    MSD43: 'RECOMBIVAX-ADULT',
    MSD44: 'RECOMBIVAX-DIALYSIS',
    MSD08: 'RECOMBIVAX-PEDS',
    SKB119: 'ROTARIX',
    MSD116: 'ROTATEQ',
    MBL09: 'TD(GENERIC)',
    NONE09: 'Td, (adult)',
    AKR09: 'Td, adsorbed',
    PMC113: 'Tenivac',
    PMC35: 'TETANUS TOXOID (GENERIC)',
    NONE22: 'TETRAMUNE',
    OTC19: 'TICE BCG',
    PMC50: 'TRIHIBIT',
    PMC20: 'TRIPEDIA',
    PFR162: 'Trumenba',
    SKB104: 'TWINRIX',
    PMC101: 'TYPHIM VI',
    NONE53: 'TYPHOID-AKD',
    MSD52: 'VAQTA-ADULT',
    MSD83: 'VAQTA-PEDS',
    MSD21: 'VARIVAX',
    PAX174: 'VAXCHORA',
    PAX25: 'Vivotif',
    CRU25: 'VIVOTIF BERNA',
    PMC37: 'YF-VAX',
    MSD121: 'ZOSTAVAX'
  }

  def self.create_trade_name_key(cvx_code, mvx_code)
    if mvx_code == '' || mvx_code.nil?
      mvx_code = 'NONE'
    end
    mvx_code = mvx_code.upcase
    if cvx_code > 0 && cvx_code < 10
      cvx_code = '0' + cvx_code.to_s
    end
    "#{mvx_code}#{cvx_code}".to_sym
  end

  def trade_name_lookup(cvx_code, mvx_code)
    trade_name_key = create_trade_name_key(cvx_code, mvx_code)
    TRADENAMES[trade_name_key]
  end


  def find_all_vax_codes_by_cvx(cvx_code)
    return_vax_codes = []
    VAXCODES.each do |key, value|
      if value.map { |element| element[3] }.include?(cvx_code)
        return_vax_codes << key
      end
    end
    raise "No Vaccine Codes Found for cvx #{cvx_code}" if return_vax_codes == []
    return_vax_codes
  end
  public_constant(:VAXCODES, :TRADENAMES)
  module_function :find_all_vax_codes_by_cvx, :trade_name_lookup
end

# vax_codes =  [
#   'FLU', 'FLU6', 'FLU8', 'FL13', 'H1N2', 'H1N3', 'H1N1', 'HAV2', 'HAV1', 'HAV6', 'HBV2',
#   'HBV1', 'HPV2', 'JEV', 'MMR1', 'MCV1', 'MPV1', 'PCV4', 'PPV1', 'IPV1', 'RAB1', 'ZOS',
#   'TDP1', 'Td', 'PPD1', 'TWN2', 'TWN1', 'TYP', 'VAR1', 'YFV', 'BCG', 'FL11', 'HAV4', 'HBV3',
#   'HPV5', 'MCV3', 'MMR3', 'PPV2', 'TD4', 'TDP4', 'TWN3', 'VAR4', 'DT', 'DTaP', 'DTHI', 'DTH',
#   'DHI', 'DTI', 'DTP', 'DTP2', 'FLU4', 'FLU3', 'FLU2', 'FL10', 'FLU9', 'FLU7', 'H1N7', 'H1N5',
#   'H1N6', 'H1N4', 'HBHB', 'HAV3', 'HEPA', 'HepB', 'HIB2', 'HPV6', 'HPV', 'IPV', 'MMR', 'MCV6',
#   'MCV4', 'MCV5', 'MCV7', 'MPSV', 'MMRV', 'OPV', 'PCV2', 'PCV', 'POL', 'ROT1', 'ROTA', 'TD2',
#   'TDP2', 'VAR2', 'DTP3', 'DTPz', 'ENC', 'FLUZ', 'FLZ', 'HPV3', 'H1N8', 'HAV', 'HAV9', 'HAV5',
#   'HBIG', 'HBV9', 'HBV5', 'HBV4', 'HBV6', 'PRPO', 'HIB3', 'HbOC', 'PRPT', 'HIB4', 'HIB5', 'HIB',
#   'HPV4', 'HPV9', 'IG', 'FL14', 'FLU5', 'MEA', 'MMR9', 'MERU', 'MCV9', 'MPM', 'PCV9', 'PPV9',
#   'PCV3', 'IPVz', 'IPV2', 'MMR2', 'TD3', 'TDP3', 'PPD2', 'VAR3', 'RAB2', 'RIG', 'ROT2', 'Rub',
#   'S', 'SPOX', 'SMP', 'TD5', 'TDP9', 'TD9', 'PPD9', 'PPD', 'TWNz', 'TYP2', 'TYPH', 'VAR9',
#   'VZIG', 'Var'
# ]

# Missing vax codes discovered in test data 091616 are DTap, 5 pertussis antigens (106) and C-Hep B/HIB (51)
